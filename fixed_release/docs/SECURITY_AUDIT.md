# üîí –û—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Telegram Shipping Bot

–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: 18.11.2024

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π
- ‚úÖ **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞**: –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ `sanitize_string()`
- ‚úÖ **HTML-—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `html.escape()`
- ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤**: –£–¥–∞–ª—è—é—Ç—Å—è `<>"'%;(){}[]`
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ–ª–µ–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞

### 2. –ó–∞—â–∏—Ç–∞ API
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞**: –í—Å–µ –∞–¥–º–∏–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã `verify_admin_key`
- ‚úÖ **API –∫–ª—é—á**: –¢—Ä–µ–±—É–µ—Ç—Å—è `X-API-Key` header –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**: –ß–µ—Ä–µ–∑ `security_manager`

### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
- ‚úÖ **Debouncing –∫–Ω–æ–ø–æ–∫**: –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ (1 —Å–µ–∫)
- ‚úÖ **Stale interaction check**: –ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç–∞—Ä—ã—Ö/—É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ **Session timeout**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π (60 –º–∏–Ω)

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **MongoDB**: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç NoSQL injection)
- ‚úÖ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ `.env` —Ñ–∞–π–ª–µ
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö**: –í—Å–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–¥–º–∏–Ω—É
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö**: –ê–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º label
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**: –û–ø–ª–∞—Ç—ã, —Å–æ–∑–¥–∞–Ω–∏–µ label, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

### 6. –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ **User authentication**: –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Telegram
- ‚úÖ **Session management**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **Order ownership**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã

## ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. Rate Limiting (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π)
**–°—Ç–∞—Ç—É—Å**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
# –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
from slowapi import Limiter, _rate_limit_exceeded_handler
limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter

@app.get("/api/orders")
@limiter.limit("10/minute")
async def get_orders():
    ...
```

### 2. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–∏–∑–∫–∏–π)
**–°—Ç–∞—Ç—É—Å**: –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –®–∏—Ñ—Ä–æ–≤–∞—Ç—å email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—ã –≤ –ë–î
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cryptography.fernet` –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –®–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ MongoDB
- –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—Ç—å –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

### 3. 2FA –¥–ª—è –∞–¥–º–∏–Ω–∞ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π)
**–°—Ç–∞—Ç—É—Å**: –¢–æ–ª—å–∫–æ API –∫–ª—é—á  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- OTP –∫–æ–¥—ã —á–µ—Ä–µ–∑ Telegram
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–æ–≤

### 4. HTTPS Only (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í—ã—Å–æ–∫–∏–π)
**–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ production  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç HTTPS
- Redirect —Å HTTP –Ω–∞ HTTPS
- HSTS –∑–∞–≥–æ–ª–æ–≤–∫–∏

### 5. Input Validation (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π)
**–°—Ç–∞—Ç—É—Å**: –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –£—Å–∏–ª–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ email (regex)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (regex)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ZIP –∫–æ–¥–æ–≤ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–¥—ã)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–æ–≤ (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞)

## üìä –û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|-------------|
| –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π | üü¢ –•–æ—Ä–æ—à–æ | –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ |
| API Security | üü¢ –•–æ—Ä–æ—à–æ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç |
| Session Management | üü¢ –•–æ—Ä–æ—à–æ | TTL –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | üü¢ –û—Ç–ª–∏—á–Ω–æ | –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –∞–ª–µ—Ä—Ç—ã |
| Rate Limiting | üî¥ –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å |
| Data Encryption | üü° –°—Ä–µ–¥–Ω–µ | –¢–æ–ª—å–∫–æ –≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ |
| 2FA | üî¥ –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |

## üéØ –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 7/10

**–í—ã–≤–æ–¥**: –ë–æ—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –±–∞–∑–æ–≤—É—é –∑–∞—â–∏—Ç—É, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –û—Å–Ω–æ–≤–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫ –∑–∞–∫—Ä—ã—Ç—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:
- ‚úÖ SQL/NoSQL –∏–Ω—ä–µ–∫—Ü–∏–∏
- ‚úÖ XSS –∞—Ç–∞–∫–∏
- ‚úÖ –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (debouncing)
- ‚úÖ –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Å–µ—Å—Å–∏–∏

### –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- ‚ö†Ô∏è DDoS –∞—Ç–∞–∫–∏
- ‚ö†Ô∏è Brute force –∞—Ç–∞–∫–∏ –Ω–∞ API –∫–ª—é—á
- ‚ö†Ô∏è Session hijacking
- ‚ö†Ô∏è CSRF –∞—Ç–∞–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.*
